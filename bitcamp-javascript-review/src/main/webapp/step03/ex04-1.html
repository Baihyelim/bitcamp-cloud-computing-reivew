<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>자바스크립트</title>
</head>
<body>
<h1>클로저(closure) - 바깥 함수의 로컬 변수 복제</h1>

<script>
"use strict"

function f1(p1) {
    
    var sum = 0;
    for (var i = 1; i <= p1; i++)
        sum += i; // sum = sum+i;
      //              2   = 0 + 2
      // i=2 // sum 2
      // sum = sum + i;
      //  2  =   2  +  2+1
      //  5  =        3
      // sum = sum + i;
      //  5  =  5  + 3+1
      //  9          4  
     // 총 값은 = 55; sum = 55 복제한다.-> 사라지기 전에 클로저라는 메모리에 최종 값을 저장한다.

    var x = function() {
        console.log("합계=", sum);
        // sum 변수처럼 내부 함수에서 바깥 함수의 로컬 변수를 참조한다면
        // 내부 함수들은 closure만 사용하는 별도의 메모리에 
        // 참조하는 바깥 함수의 변수를 복제해 둔다.
        // 왜? 바깥 함수의 호출이 끝나 로컬 변수가 사라지더라도 
        // 자신은 영향을 받지 않고 그 변수의 값을 사용하기 위함이다.
    }
    
    return x;
}
// 모든 함수는 실행을 완료하고 종료 하였다. 없다 값이 다 날렸다.
var a = f1(10); // f1()은 내부에서 정의한 함수를 리턴한다.
a();



</script>


</body>
</html>






